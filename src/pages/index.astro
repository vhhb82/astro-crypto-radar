---
import Layout from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

export const prerender = true;

// articole publice, cele mai noi primele
const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => {
    const ad = new Date(a.data.pubDate || 0).getTime();
    const bd = new Date(b.data.pubDate || 0).getTime();
    return bd - ad;
  });
---

<Layout title="Crypto Radar — Blog">
  <main class="prose mx-auto">
    <h1>Ultimele articole</h1>

    {posts.length === 0 ? (
      <p>Încă nu există articole publice.</p>
    ) : (
      <ul>
        {posts.map((p) => (
          <li>
            <a href={`/blog/${p.slug}/`}>{p.data.title}</a>
            {p.data.pubDate && <> — {new Date(p.data.pubDate).toLocaleDateString('ro-RO')}</>}
            {p.data.description && <div><small>{p.data.description}</small></div>}
          </li>
        ))}
      </ul>
    )}
  </main>
</Layout>


