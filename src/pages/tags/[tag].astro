---
import Base from '@/layouts/Base.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog', ({ data }) => !data.draft);
  const tags = [...new Set(posts.flatMap(p => p.data.tags))];
  return tags.map(tag => ({
    params: { tag },
    props: {
      tag,
      posts: posts.filter(p => p.data.tags.includes(tag)),
    },
  }));
}

const { tag, posts } = Astro.props as { tag: string; posts: any[] };
---
<Base title={`Articole #${tag} – Crypto Radar`} description={`Postări cu tagul ${tag}`}>
  <h1 class="text-2xl font-bold mb-4">#{tag}</h1>
  <ul class="space-y-6">
    {posts.map((p) => (
      <li>
        <a class="text-blue-600" href={`/blog/${p.slug}/`}>{p.data.title}</a>
        <p class="text-gray-600">{p.data.description}</p>
      </li>
    ))}
  </ul>
</Base>

